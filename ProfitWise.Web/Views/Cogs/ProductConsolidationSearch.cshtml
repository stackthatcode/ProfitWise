@using ProfitWise.Web.Attributes
@using ProfitWise.Web.Models
@model ProductConsolidationSearchModel
@{
    Context.PullCommonContext().PageTitle = "Search for Products to Consolidate With";
    Layout = "~/Views/Shared/_AuthenticatedPopupLayout.cshtml";
}

@Html.Partial("~/Views/SharedTemplates/_PagingWidget.cshtml")

<style>
    body {
        overflow-y: scroll !important;
        padding: 0px !important;
    }
</style>

<script type="text/html" id="Main-Template">
    <div class="fixed-header-container" style="padding-left: 0px; padding-right: 0px;">
        <div class="standard-header-sleeve" style="height: 150px;">
            <!-- This element will track with the scrollbar via JavaScript wiring to onscroll-->
            <div class="standard-header" 
                 style="width:100% !important; min-width: 0 !important; padding-top:20px; padding-right:20px; padding-left:20px; border-bottom: 1px dashed #CCC;">
                
                <div data-bind="template: { name: 'Top-Header' }"></div>
            </div>
        </div>
    </div>

    <div style="position: absolute; overflow: auto; width:100%;">
        <div style="height: 150px;"></div>
        <div style="width:100%; background-color:#FFF; overflow:auto; padding-top:0px; padding-left:30px; padding-right: 30px;">
            <table class="table table-striped">
                <tbody data-bind="foreach: SelectionsGrid">                    
                </tbody>
            </table>
        </div>
    </div>
</script>


<script type="text/html" id="Top-Header">
    <div class="row">
        <div class="col-xs-12">

        </div>
    </div>

    <div class="row">
        <div class="col-xs-6" style="text-align: left;"
             data-bind="template: { name: 'Paging-Widget', data: $data.PagingModel }">
        </div>

        <div class="col-xs-6" style="text-align: right;">
            <a href="#" data-bind="click: OkClick"
               style="width: 125px;" class="btn btn-primary"><i class="glyphicon glyphicon-ok"></i>&nbsp;Close</a>
        </div>
    </div>

</script>


    <!-- KnockoutJS Root Element -->
    <div data-bind="template: { name: 'Main-Template' }"></div>

    <script>
        var ProfitWiseWidgets = ProfitWiseWidgets || {};

        ProfitWiseWidgets.ProductVariantSelections = function() {
            var self = this;


            self.SelectionsGrid = ko.observableArray();

            self.OkClick = function() {
                ShopifyApp.Modal.close({ result: true });
            };

            self.PagingModel = new ProfitWiseWidgets.PagingModel();
            self.PagingModel.PageSize(50);
            self.PagingModel.PageNumber(1);
            self.PagingModel.Callback = self.LoadDataForCurrentPage;
            return self;
        };

        var model = new ProfitWiseWidgets.ProductVariantSelections();
        //model.LoadDataForCurrentPage();
        ko.applyBindings(model);
    
</script>
